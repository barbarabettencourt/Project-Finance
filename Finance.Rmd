---
title: "Finance"
author: "Barbara, Frederik, Sierra"
date: "26/11/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Stocks:**
Airlines:  
Lufthansa (German); DLAKY    
Scandinavian Airlines (Danish); SAS    
Norwegian Air Shuttle (Norway); NWARF    
Easy Jet (British); EZJ    
RyanAir Holdings plc (British); RYAAY    
United Airlines Holdings Inc (American); UAL    
American Airlines Group Inc (American); AAL    
Spirit Airlines Inc (American); SAVE  

Beer Industry:  
Carlsberg (Danish); CABGY
Heineken (Netherlands); HEINY  
Anheuser-Busch InBev (Belgium); BUD  
Harboe (Danish); CPH: HARB-B  
Guinness from Diageo; DEO  
Molson Coors Brewing; TAP
Tsingtao Brewery Group; OTCMKTS: TSGTF
Asahi Group Holding Ltd; OTCMKTS: ASBRF

```{r include=FALSE}
library(tidyquant)
library(purrr)
library(dplyr)
library(tidyverse)

options("getSymbols.warning4.0"=FALSE)
options("getSymbols.yahoo.warning"=FALSE)

tickers <- c('DLAKY',
             'SAS',
             'NWARF',
             'EZJ',
             'RYAAY',
             'UAL',
             'AAL',
             'SAVE',
             'CABGY',
             'HEINY',
             'BUD',
             'HARB-B.CO',
             'DEO',
             'TAP',
             'TSGTF',
             'ASBRF'
)

stock_names <- c(
  'luft',
  'SAS',
  'norwegian',
  'Easy',
  'RyanAir',
  'United',
  'American',
  'Sprit',
  'Carlsberg',
  'Heineken',
  'AB',
  'Harboe',
  'Guinness',
  'Molson',
  'Tsingtao',
  'Asahi'
)

stocks <- data.frame(tickers = tickers,
                stockname = stock_names)

```

```{r}

#example for stock of Lufthansa

time <- today()-years(5)
stocks.Lufthansa <- tq_get("DLAKY", get="stock.prices", from=time)

#daily returns

daily.Lufthansa <- stocks.Lufthansa %>% 
  tq_transmute(select = adjusted, mutate_fun = periodReturn, period = "daily", col_rename = "daily_returns")

head(daily.Lufthansa)

#monthly returns

monthly.Lufthansa <- stocks.Lufthansa %>%
  tq_transmute(select = adjusted, mutate_fun = periodReturn, period = "monthly", col_rename = "monthly_returns")

head(monthly.Lufthansa)


```

```{r}

returns <- tq_get(tickers, get="stock.prices") %>%
  group_by(symbol) %>%
  tq_transmute(select=adjusted,
               mutate_fun=periodReturn,
               period="daily",
               col_rename = "daily_return")

returns <- returns %>% 
  pivot_wider(names_from = symbol, values_from = daily_return)

```